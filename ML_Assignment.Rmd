---
title: "ML_Assignment"
output: html_document
---

```{r setup, include = FALSE}

library(dplyr)

pokemon_data = read.csv("C:/Users/alasd/Documents/MDS/ML/Assignment/Assignment 2/pokemon.csv")

```

```{r}

# Check for NAs 
colSums(is.na(pokemon_data))

```

```{r}

# Check column data types 
sapply(pokemon_data, class)

```

```{r}

# Initial data processing 
pokemon_data_clean = pokemon_data %>% 
  dplyr::select(-c(abilities, japanese_name, name, pokedex_number)) %>% # Remove unnecessary columns 
  dplyr::mutate(capture_rate = as.numeric(if_else(capture_rate == "30 (Meteorite)255 (Core)", "142.5", capture_rate))) %>% # Fix character issue 
  # Minior has a differing catch rate dependent on form based on if it is above or below 50% hp and therefore the expected value for catch rate is 
  # assumed to be (30 + 255) / 2 = 142.5 
  dplyr::mutate(generation = as.factor(generation)) %>% # Make generation a factor 
  dplyr::mutate(is_legendary = as.factor(is_legendary)) %>% # Make is_legendary a factor 
  dplyr::mutate(type1 = as.factor(type1)) %>% # Make type1 a factor 
  dplyr::mutate(type2 = as.factor(type2)) %>% # Make type2 a factor 
  dplyr::mutate(classfication = as.factor(classfication)) # Make classification a factor 

```

```{r}

# Working out most appropriate imputation technique - height_m 
hist(pokemon_data_clean$height_m) # Outliers present and not normally distributed therefore median better than mean cause less sensitive to outliers 

```

```{r}

# Working out most appropriate imputation technique - weight_kg 
hist(pokemon_data_clean$weight_kg) # Not normally distributed therefore median better than mean 

```

```{r}

# Working out most appropriate imputation technique - percentage_male 
hist(pokemon_data_clean$percentage_male) # Vast majority of values are 50 therefore mode makes most sense 

```


```{r}

# Impute NA values 
pokemon_data_clean = pokemon_data_clean %>% 
  dplyr::mutate(height_m = if_else(is.na(height_m), median(height_m, na.rm = TRUE), height_m)) %>% # Impute height_m NAs with median 
  dplyr::mutate(weight_kg = if_else(is.na(weight_kg), median(weight_kg, na.rm = TRUE), weight_kg)) %>% # Impute weight_kg NAs with median 
  dplyr::mutate(percentage_male_cat = case_when(is.na(percentage_male) ~ "Genderless", 
                                            percentage_male == 50 ~ "50/50",
                                            percentage_male < 50 ~ "<50",
                                            percentage_male > 50 ~ ">50")) %>% # Categorise percentage male 
  dplyr::mutate(percentage_male_cat = as.factor(percentage_male_cat)) %>% # Make percentage_male_cat a factor 
  dplyr::select(-percentage_male) # Remove percentage_male column 

# TODO: Can manually get specific height and weight values from serebii instead of imputing 

```

```{r}

# Check for any NAs 
any(is.na(pokemon_data_clean))

```

